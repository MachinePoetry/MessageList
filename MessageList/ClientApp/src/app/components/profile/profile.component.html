<noscript>
  <div class="panel panel-default">
    <div class="panel-heading text-center">
      <h3>Упс! Что-то пошло не так!</h3>
    </div>
    <div class="panel-body text-center">
      <h5>Ваш браузер не обрабатывает JavaScript</h5>
      <h5>Зайдите в настройки браузера и включите обработку скриптов</h5>
    </div>
  </div>
</noscript>

<app-header [authUserInfo]="authUserInfo"></app-header>

<app-toasts class="toasts-container"></app-toasts>

<div class="container-fliud">
  <div class="container profile-container">
    <div class="row mt-5">
      <div class="col-12 col-lg-10 offset-lg-1 profile-panel round-border-top">
        <h1 class="text-center">Профиль</h1>
      </div>
      <div class="col-12 col-lg-10 offset-lg-1 profile-content">
        <div class="row align-items-center">
          <div class="col-5 col-sm-7"><p class="mt-5 ml-sm-2 ml-md-5" id="serverUptimeLabel"> Аптайм сервера: </p></div>
          <div class="col-7 col-sm-5"><p class="mt-5 text-success" id="serverUptime"> {{uptime | secondsToTime: 'uptime' || 'Загрузка...'}} </p></div>
        </div>
        <div class="row align-items-center">
          <div class="col-12 col-lg-10 offset-lg-1">
            <h4 class="mt-3 text-center">Личные данные:</h4>
          </div>
        </div>
        <div class="row align-items-center">
          <div class="col-5 col-sm-7"><p class="mt-4 ml-sm-2 ml-md-5" id="authUserEmailLabel"> Email: </p></div>
          <div class="col-7 col-sm-5"><p class="mt-4 text-danger text-break" id="authUserEmail"> {{authUserInfo?.email || 'Загрузка...'}} </p> </div>
        </div>
        <div class="row align-items-center">
          <div class="col-5 col-sm-7"><p class="mt-3 ml-sm-2 ml-md-5" id="userCreatedAtLabel"> Дата регистрации: </p></div>
          <div class="col-7 col-sm-5"><p class="mt-3 text-success" id="userCreatedAt"> {{authUserInfo?.createdAt | dateToLocale: 'ru' || 'Загрузка...'}} </p></div>
        </div>
        <div class="row align-items-center">
          <div class="col-5 col-sm-7">
            <p class="mt-2 ml-sm-2 ml-md-5" id="loadedMessagesAmountLabel"> Количество единовременно загружаемых сообщений: </p>
          </div>
          <div class="col-7 col-sm-5"><p class="mt-3 text-success"> {{(authUserInfo?.messagesToLoadAmount === 0 ? 'Все' : authUserInfo?.messagesToLoadAmount) || 'Загрузка...'}} </p></div>
        </div>
        <div class="row align-items-center">
          <div class="col-12 col-lg-10 offset-lg-1">
            <h4 class="mt-3 text-center">Изменение личных данных:</h4>
          </div>
        </div>
        <div class="row align-items-center">
          <div class="col-5 col-sm-7">
            <p class="mt-4 ml-sm-2 ml-md-5" id="changeLoadedMessagesAmountLabel">
              Изменить количество единовременно загружаемых сообщений
              <i class="mdi mdi-lg mdi-help-circle-outline" placement="top" ngbTooltip="Укажите новое количество единовременно загружаемых сообщений.&#10;Минимум 20, максимум 10000. Или все сразу.">
              </i> :
            </p>
          </div>
          <div class="col-7 col-sm-5">
            <div class="d-flex align-items-center w-100 mt-4">
              <form #messagesToLoadForm="ngForm" id="messagesToLoadForm" (ngSubmit)="onSubmit(messagesToLoadForm)" novalidate>
                <input type="number" #messagesToLoad="ngModel" class="form-control" id="messagesToLoadCount" name="messagesToLoadCount"
                       [ngClass]="{'submit-error': messagesToLoadForm.submitted && !messagesToLoadForm.control.disabled && (messagesToLoadAmount < 20 || messagesToLoadAmount > 10000)}"
                       [(ngModel)]="messagesToLoadAmount" required min="20" max="10000" [disabled]="loadAllMessages">
              </form>
              <button type="submit" class="btn dark-login-button ml-2 ml-sm-3" form="messagesToLoadForm" id="messagesToLoadFormButton">
                <span class="dark-color-text"> Сохранить </span>
              </button>
            </div>
            <div class="d-flex align-items-center w-90 ml-4">
              <input type="checkbox" class="form-check-input mt-1" name="loadAllMessages" [(ngModel)]="loadAllMessages">
              <span class="lh-1 mt-1 mt-sm-0" (click)="loadAllMessages = !loadAllMessages" id="loadAllMessagesLabel"> Загружать все </span>
            </div>
          </div>
        </div>
        <div class="row align-items-center">
          <div class="col-7 col-sm-5">
            <p class="mt-4 ml-sm-2 ml-md-5" id="changePasswordLabel">
              Изменить пароль:
            </p>
            <change-password [authUserInfo]="authUserInfo" [mode]="changePasswordMode.profile" (processChangePasswordResult)="getChangedPasswordResult($event)"></change-password>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
